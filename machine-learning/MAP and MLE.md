---
typora-root-url: ../../study_note
---

# 概率和统计

概率：已知一个模型和参数，如何预测这个模型产生的特性（例如均值、方差、协方差）

统计：有数据，推测模型和参数。

概率是已知模型和参数，推数据。统计是已知数据，推模型和参数。

## 频率学派

频率学派以：
	似然函数、最大似然函数、最大似然估计

​	**似然**：我通过掷硬币去推测硬币的参数，就叫**似然**。

​	通过证据（或者实验），去推测出模型**最可能的参数**就是**最大似然估计**。

### 似然函数

$$
P(data|\theta) = \prod_{n=1}^N{p(x_n|\theta)} \\ data = (x_1,x_2,...,x_n)\\ \theta = (p_1,p_2,..,p_n)
$$

输入有两个：$data$表示一个具体的数据（正反面）；$\theta$表示模型的参数（概率大小）。

1. 如果$\theta$已知，$data$是变量，这个函数叫做概率函数(probability function)，它描述对于不同的样本点$data$，其出现的概率是多少。

   比如抛硬币，已知正反面（H、T）的概率各为$p_H=p_T=\frac{1}{2}​$,$p(H|\theta)=\frac{1}{2}、p(HH|\theta)=p_H\times p_H​$

   

2. 如果$data$是已知确定的，$\theta$是变量，这个函数叫做似然函数(likelihood function)，它描述对于不同模型参数，出现$x$这个样本点的概率是多少。

### 最大似然原理

最大似然估计是在总体的分布类型已知的条件下所使用的一种参数估计方法。
极大似然估计法是基于极大似然原理提出的。

最大似然原理：
概率大的事情在一次观测中更容易发生。

### 最大似然估计(MLE)

假设硬币不均匀，拿到硬币，抛硬币，正反面出现的概率(记为$\theta$)各是多少。

抛了十次得到的数据$data$是七次正面。我们想求正面概率$\theta$是模型参数，所以：
$$
f(data,\theta)=\theta^7(1-\theta)^3
$$

最大似然函数，就是让$f(\theta)$最大化。



可以看出，在$\theta=0.7$时，似然函数取得最大值。

意思就是：当我们抛十次硬币，发现七次向上，最大似然估计认为正面向上的概率是0.7

肯定会有人说就是0.5，0.7是错的。
我现在想知道硬币掷出正面的概率是多少？一般会认为这肯定是1/2，可是如果100次99次都是正面，还是独立的吗？会不会硬币本身就有问题，概率本来就不是1/2？



最大似然函数就是用实验结果估计概率，比如，我掷十次硬币，九次朝上，我就认为正面向上的概率为$\frac{9}{10}​$

## 贝叶斯派

### 贝叶斯公式

$$
P(A|B)=\frac{P(B|A)P(A)}{P(B)}
$$
把B展开

$$
P(A|B)=\frac{P(B|A)P(A)}{P(B|A)P(A)+P(B|\overline A)P(\overline A)}
$$

表示有多大把握相信一件证据。

### 最大后验概率估计

贝叶斯派认为，在估计一个东西之前，要有经验性的判断，然后根据数据去调整判断。而这个判断就是先验概率，经过调整后的概率就是后验概率。贝叶斯公式可以写成：
$$
P(\theta|data) = \frac{P(data|\theta)\times P(\theta)}{P(data)}
$$

$P(data|\theta)$是之前讲的似然函数，$P(\theta)$是先验概率。

最大后验概率估计是想求$\theta$使$P(data|\theta)P(\theta)$最大。求得的$\theta$不仅仅使似然函数大，也使$\theta$自己出现的先验概率也得大。

MAP其实是在最大化$P({\theta}|{data})=\frac{P(data|\theta)P(\theta)}{P(data)}$，不过$data$是确定的。$P(data)$是一个已知的值，所以去掉分母。（假设“投10次硬币”是一次实验，实验做了1000次，$data$出现了n次，则$P(data)=n/10000$。这是一个可以由数据集得到的值。）

最大化$P(\theta|data)​$的意义：$data​$已经出现了，要求$\theta​$取什么值使得$P(\theta|data)​$最大。

最大化$P(\theta|data)$,这个就是最大后验概率。

我们使用一个高斯分布来表示$P(\theta)​$，均值0.5，方差0.1。
$P(\theta)​$:

![20170531004009269.png]()

$P(data|\theta)P(\theta)$:

![20170531003829147.png](image/E9357F4D7924A14B227EC9F11E3C69BC.png)

$\theta$ 取值已向左偏移，不再是0.7
实际上，在$\theta=0.558$时函数取得了最大值。即，用最大后验概率估计，得到$\theta=0.558$.

上面的例子可能不太明显，通俗来说，假设我今天拿到一枚硬币，我根据经验将P(\theta)设置为0.5了。然后我不断的抛硬币，出现的都是正面，如下图：

![v2-c3f4e1e00bec339016dbc4c448613ab5\_r.jpg](image/coin.jpg)

在抛了100次后，由于先验概率的存在，我依然不会把硬币正面概率设为1，而传统的频率派会认为此时正面向上概率就是1.

## 最大似然估计和最大后验估计的区别

MAP就是多个作为因子的先验概率P(θ)。或者，也可以反过来，认为MLE是把先验概率P(θ)认为等于1，即认为θ是均匀分布。